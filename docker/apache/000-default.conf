<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html/public
    
    # Configuration du répertoire racine
    <Directory /var/www/html/public>
        AllowOverride All
        Require all granted
        
        # Configuration des réécritures d'URL
        RewriteEngine On
        
        # Redirection vers index.php si le fichier n'existe pas
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index.php [QSA,L]
    </Directory>
    
    # Configuration des logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
    
    # Configuration des en-têtes de sécurité
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    
    # Configuration du cache pour les assets statiques
    <FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 month"
        Header set Cache-Control "public, immutable"
    </FilesMatch>
    
    # Configuration pour les uploads
    <Directory /var/www/html/uploads>
        AllowOverride None
        Require all granted
    </Directory>
    
    # Configuration pour le cache
    <Directory /var/www/html/cache>
        AllowOverride None
        Require all denied
    </Directory>
</VirtualHost>
